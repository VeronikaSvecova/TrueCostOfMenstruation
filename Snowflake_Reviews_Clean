/* DataFrame připravený v Pandas doplňujeme o značky, doplňujeme kategorie produktů
a odstraňujeme produkty,které nejsou součástí analýzy.Jako základ využíváme kód 
z úvodní části projektu. 
*/

CREATE OR REPLACE TABLE REVIEWS_CLEAN AS
SELECT
    CASE WHEN "itemName_HEUREKA" ILIKE'Always%' THEN 'ALWAYS'
   WHEN "itemName_HEUREKA" ILIKE'%Bellinda%' THEN 'BELLINDA'
   WHEN "itemName_HEUREKA" ILIKE'%Tampax%' THEN 'TAMPAX'
   WHEN "itemName_HEUREKA" ILIKE'%snuggs%' THEN 'SNUGGS'
   WHEN "itemName_HEUREKA" ILIKE'%jessa%' THEN 'JESSA'
   WHEN "itemName_HEUREKA" ILIKE'%Naturella%' THEN 'NATURELLA'
   WHEN "itemName_HEUREKA" ILIKE'%RIA%' THEN 'RIA'
   WHEN "itemName_HEUREKA" ILIKE'%o.b.%' THEN 'O.B.'
   WHEN "itemName_HEUREKA" ILIKE'%selenacare%' THEN 'SELENACARE'
   WHEN "itemName_HEUREKA" ILIKE'%GENTLEDAY%' THEN 'GENTLE DAY'
   WHEN "itemName_HEUREKA" ILIKE'%KOTEX%' THEN 'KOTEX'
   WHEN "itemName_HEUREKA" ILIKE'%T.O.C%' THEN 'T.O.C'
   WHEN "itemName_HEUREKA"ILIKE'%EBELIN%' THEN 'EBELIN'
   WHEN "itemName_HEUREKA" ILIKE'%MOONCUP%' THEN 'MOONCUP'
   WHEN "itemName_HEUREKA" ILIKE'%NATRACARE%' THEN 'NATRACARE'
   WHEN "itemName_HEUREKA" ILIKE'%CARIN%' THEN 'CARIN'
   WHEN "itemName_HEUREKA" ILIKE'%NAT%' THEN 'ECO BY NATY'
   WHEN "itemName_HEUREKA" ILIKE'%BELLA%' THEN 'BELLA'
   WHEN "itemName_HEUREKA" ILIKE'%ORGANYC%' THEN 'ORGANYC'
   WHEN "itemName_HEUREKA" ILIKE'%LIBRESSE%' THEN 'LIBRESSE'
   WHEN "itemName_HEUREKA" ILIKE'%YUUKI%' THEN 'YUUKI'
   WHEN "itemName_HEUREKA" ILIKE'%CAREFREE%' THEN 'CAREFREE'
   WHEN "itemName_HEUREKA" ILIKE'%SENTA PROTECT%' THEN 'SENTA PROTECT'
   WHEN "itemName_HEUREKA" ILIKE'%MONETA%' THEN 'MONETA'
   WHEN "itemName_HEUREKA" ILIKE'%MASMI%' THEN 'MASMI'
   WHEN "itemName_HEUREKA" ILIKE'%ATTENDS%' THEN 'ATTENDS'
   WHEN "itemName_HEUREKA" ILIKE'%PINKE WELLE%' THEN 'PINKE WELLE'
   WHEN "itemName_HEUREKA" ILIKE'%FUN FACTORY%' THEN 'FUN FACTORY'
   WHEN "itemName_HEUREKA" ILIKE'%SATISFYER%' THEN 'SATISFYER'
   WHEN "itemName_HEUREKA" ILIKE'%ELLEN%' THEN 'ELLEN'
   WHEN "itemName_HEUREKA" ILIKE'%SAFORELLE%' THEN 'SAFORELLE'
   WHEN "itemName_HEUREKA" ILIKE'%TIERRA VERDE%' THEN 'TIERRA VERDE'
   WHEN "itemName_HEUREKA" ILIKE'%evita%' THEN 'EVITA'
   WHEN "itemName_HEUREKA" ILIKE'%LADYCUP%' THEN 'LADYCUP'
   WHEN "itemName_HEUREKA" ILIKE'%GENTLE DAY%' THEN 'GENTLE DAY'
   WHEN "itemName_HEUREKA" ILIKE'%INTIMEA%' THEN 'SABA INTIMA'
   WHEN "itemName_HEUREKA" ILIKE'%TENA%' THEN 'TENA'
   WHEN "itemName_HEUREKA" ILIKE'%DISCREET%' THEN 'DISCREET'
   WHEN "itemName_HEUREKA" ILIKE'%GAIA CUP%' THEN 'GAIA CUP'
   WHEN "itemName_HEUREKA" ILIKE'%JT%' THEN 'JEDEN TAG'
   WHEN "itemName_HEUREKA" ILIKE'%JEDEN TAG%' THEN 'JEDEN TAG'
   WHEN "itemName_HEUREKA" ILIKE'%ANAÉ BY ECO%' THEN 'ANAÉ BY ECODIS'
   WHEN "itemName_HEUREKA" ILIKE'%PANTY%' THEN 'ANAÉ BY ECODIS'
   WHEN "itemName_HEUREKA" ILIKE'%SLOGGI%' THEN 'SLOGGI'
   WHEN "itemName_HEUREKA" ILIKE'%MODIBODI%' THEN 'MODIBODI'
   WHEN "itemName_HEUREKA" ILIKE'%FLUX%' THEN 'FLUX'
   WHEN "itemName_HEUREKA" ILIKE'%DIM%' THEN 'FLUX'
   WHEN "itemName_HEUREKA" ILIKE'%MERACUS%' THEN 'MERACUS'
   WHEN "itemName_HEUREKA" ILIKE'%SAYU%' THEN 'SAYU'
   WHEN "itemName_HEUREKA" ILIKE'%REPETKY%' THEN 'REPETKY'
   WHEN "itemName_HEUREKA" ILIKE'%BODYLOK%' THEN 'BODYLOK'
   WHEN "itemName_HEUREKA" ILIKE'%TRIUMPH%' THEN 'TRIUMPH'
   WHEN "itemName_HEUREKA" ILIKE'%BAMBOOLIK%' THEN 'BAMBOOLIK'
   WHEN "itemName_HEUREKA" ILIKE'%WHOOP%' THEN 'WHOOP DE DOO'
   WHEN "itemName_HEUREKA" ILIKE'%MERULA%' THEN 'MERULA'
   WHEN "itemName_HEUREKA" ILIKE'%ORGANIC%' THEN 'ORGANIC'
   WHEN "itemName_HEUREKA" ILIKE'%LAMAZUNA%' THEN 'LAMAZUNA'
   WHEN "itemName_HEUREKA" ILIKE'%LADY CUP%' THEN 'LADYCUP'
   WHEN "itemName_HEUREKA" ILIKE'%FUN CUP%' THEN 'FUN CUP'
   WHEN "itemName_HEUREKA" ILIKE'%GAIA%' THEN 'GAIA CUP'
   WHEN "itemName_HEUREKA" ILIKE'%INTIMFITNESS%' THEN 'INTIM FITNESS'
   WHEN "itemName_HEUREKA" ILIKE'%MERUŇKOVÝ%' THEN 'LUNA CUP'
   WHEN "itemName_HEUREKA" ILIKE'%MALINOVÝ%' THEN 'LUNA CUP'
   WHEN "itemName_HEUREKA" ILIKE'%ELKOS%' THEN 'ELKOS'
   WHEN "itemName_HEUREKA" ILIKE'%BEPPY%' THEN 'BEPPY'
   WHEN "itemName_HEUREKA" ILIKE'%VUOKKOSET%' THEN 'VUOKKOSET'
   WHEN "itemName_HEUREKA" ILIKE'%FLO%' THEN 'FLO'
   WHEN "itemName_HEUREKA" ILIKE'%SHUYA%' THEN 'SHUYA'
   WHEN "itemName_HEUREKA" ILIKE'%EVAX%' THEN 'EVAX'
   WHEN "itemName_HEUREKA" ILIKE'%TIANDE%' THEN 'TIANDE'
   WHEN "itemName_HEUREKA" ILIKE'%AUSONIA%' THEN 'AUSONIA'
   WHEN "itemName_HEUREKA" ILIKE'%T-TOMI%' THEN 'T-TOMI'
   WHEN "itemName_HEUREKA" ILIKE'%BAMBAW%' THEN 'BAMBAW'
   WHEN "itemName_HEUREKA" ILIKE'%RENOVA%' THEN 'RENOVA'
   WHEN "itemName_HEUREKA" ILIKE'%PETIT LULU%' THEN 'PETIT LULU'
   WHEN "itemName_HEUREKA" ILIKE'%FEMINTIMATE%' THEN 'FEMINTIMATE'
   WHEN "itemName_HEUREKA" ILIKE'%LIEBE%' THEN 'LIEBE'
   WHEN "itemName_HEUREKA" ILIKE'%MICCI%' THEN 'MICCI'
   WHEN "itemName_HEUREKA" ILIKE'%HOT LADY%' THEN 'HOT LADY'
   WHEN "itemName_HEUREKA" ILIKE'%JOYDIVISION%' THEN 'JOYDIVISION'
   WHEN "itemName_HEUREKA" ILIKE'%INDASEC%' THEN 'INDASEC'
   WHEN "itemName_HEUREKA" ILIKE'%TIENS%' THEN 'TIENS'
   WHEN "itemName_HEUREKA" ILIKE'%LAURA COLUTTI%' THEN 'LAURA COLUTTI'
   WHEN "itemName_HEUREKA" ILIKE'%DEPEND%' THEN 'DEPEND'
   WHEN "itemName_HEUREKA" ILIKE'%LOVE LUNA%' THEN 'LOVE LUNA'
   WHEN "itemName_HEUREKA" ILIKE'%MAMI CUP%' THEN 'MAMICUP'
   WHEN "itemName_HEUREKA" ILIKE'%LUNETTE%' THEN 'LUNETTE'
   WHEN "itemName_HEUREKA" ILIKE'%PAPPERLACUP%' THEN 'PAPPERLACUP'
   WHEN "itemName_HEUREKA" ILIKE'%NINA%' THEN 'NINA CUP'
   WHEN "itemName_HEUREKA" ILIKE'%KUPPY%' THEN 'INNOVAGOODS'
   WHEN "itemName_HEUREKA" ILIKE'%FAIR SQUARED%' THEN 'FAIR SQUARED'
   WHEN "itemName_HEUREKA" ILIKE'%Krajka Hi-Waist%' THEN 'BODYLOK'
   WHEN "itemName_HEUREKA" ILIKE'%DORINA%' THEN 'DORINA'
   WHEN "itemName_HEUREKA" ILIKE'%UNDERBELLY%' THEN 'UNDERBELLY UNIVERSE'
   WHEN "itemName_HEUREKA" ILIKE'%Krajka Hi-Waist růžová%' THEN 'BODYLOK'
   WHEN "itemName_HEUREKA" ILIKE'%MAMICUP%' THEN 'MAMICUP'
   ELSE 'Zařadit'
   END AS "Brand"
    ,"itemName_HEUREKA"
    ,"itemUrl_HEUREKA"
    ,"ratings"
    ,"ratings_avg"
    ,"reviews"
    ,CASE 
    WHEN "TYP_HEUREKA" ILIKE '%Menstruační kalhotky%' THEN 'menstruační kalhotky'
    WHEN "TYP_HEUREKA" ILIKE '%tampony%' OR "TYP_HEUREKA" ILIKE '%tampóny%' THEN 'tampony' 
    WHEN "TYP_HEUREKA" ILIKE '%vložky%' THEN 'vložky'
    WHEN "TYP_HEUREKA" ILIKE '%kalíšek%' THEN 'menstruační kalíšek'
    ELSE 'někde máme chybu'
    END as "typ"
FROM "union_reviews"
WHERE 
    ("itemName_HEUREKA" ILIKE '%vložky%' 
    AND "itemName_HEUREKA" NOT ILIKE '%porodnické%'
    AND "itemName_HEUREKA" NOT ILIKE '%inkon%'
    AND "itemName_HEUREKA" NOT ILIKE'%con%'
    AND "itemName_HEUREKA" NOT ILIKE'%A5%'
    AND "itemName_HEUREKA" NOT ILIKE'%A4%'
    AND "itemName_HEUREKA" NOT ILIKE'%chladící%'
    AND "itemName_HEUREKA" NOT ILIKE '%skelet%' 
    AND "itemName_HEUREKA" NOT ILIKE '%slipové%'
    AND "itemName_HEUREKA" NOT ILIKE '%gel%'
    AND "itemName_HEUREKA" NOT ILIKE '%dr.grepl%'
    AND "itemName_HEUREKA" NOT ILIKE '%dr. grepl%'
    AND "itemName_HEUREKA" NOT ILIKE '%bot%'
    AND "itemName_HEUREKA" NOT ILIKE '%scholl%'
    AND "itemName_HEUREKA" NOT ILIKE '%prsní%' 
    AND "itemName_HEUREKA" NOT ILIKE '%podprsen%'
    AND "itemName_HEUREKA" NOT ILIKE '%latko%'
    AND "itemName_HEUREKA" NOT ILIKE '%polo%' 
    AND "itemName_HEUREKA" NOT ILIKE '%deo%'
    AND "itemName_HEUREKA" NOT ILIKE '%absorpční%'
    AND "itemName_HEUREKA" NOT ILIKE '%inkont%' 
    AND "itemName_HEUREKA" NOT ILIKE '%do bot%' 
    AND "itemName_HEUREKA" NOT ILIKE '%poporodní%'
    AND "itemName_HEUREKA" NOT ILIKE '%porod%'
    AND "itemName_HEUREKA" NOT ILIKE '%mateřské%'
    AND "itemName_HEUREKA" NOT ILIKE '%porodu%'
    AND "itemName_HEUREKA" NOT ILIKE '%obuv%'
    AND "itemName_HEUREKA" NOT ILIKE '%noh%'
    AND "itemName_HEUREKA" NOT ILIKE '%antibakterial%'
    AND "itemName_HEUREKA" NOT ILIKE '%carbon%'
    AND "itemName_HEUREKA" NOT ILIKE '%orto%') 
    AND "itemName_HEUREKA" NOT ILIKE '%int%'
    OR  ("itemName_HEUREKA" ILIKE '%menstruační kalíšek%') 
    OR  (("itemName_HEUREKA" ILIKE '%tampony%' 
    OR  "itemName_HEUREKA" ILIKE '%tampóny%') 
    AND "itemName_HEUREKA" NOT ILIKE '%odličovací%'
    AND "itemName_HEUREKA" NOT ILIKE'%bel%'
    AND "itemName_HEUREKA" NOT ILIKE '%vat%'
    AND "itemName_HEUREKA" NOT ILIKE '%peel%'
    AND "itemName_HEUREKA" NOT ILIKE '%kosm%'
    AND "itemName_HEUREKA" NOT ILIKE '%obvaz%'
    AND "itemName_HEUREKA" NOT ILIKE '%steril%'
    AND "itemName_HEUREKA" NOT ILIKE '%odlakovaci%'
    AND "itemName_HEUREKA" NOT ILIKE '%čisticí%' 
    AND "itemName_HEUREKA" NOT ILIKE '%oční%' 
    AND "itemName_HEUREKA" NOT ILIKE '%oči%' 
    AND "itemName_HEUREKA" NOT ILIKE '%čistící%' 
    AND "itemName_HEUREKA" NOT ILIKE '%kosmetické%'
    AND "itemName_HEUREKA" NOT ILIKE '%bioderma%'
    AND "itemName_HEUREKA" NOT ILIKE '%lak%'
    AND "itemName_HEUREKA" NOT ILIKE '%podprs%'
    AND "itemName_HEUREKA" NOT ILIKE '%prs%'
    AND "itemName_HEUREKA" NOT ILIKE '%bavl%'
    AND "itemName_HEUREKA" NOT ILIKE '%livsane%')
    OR  "itemName_HEUREKA" ILIKE '%menstruační kalhotky%'
; 


